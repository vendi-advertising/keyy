jQuery(document).ready(function(e){function n(){Keyy.get_connection_status()||Keyy.show_qr_code("#keyy_connect_qrcode","connect"),Keyy.register_listener("connect",function(n){if(console.log("Keyy: remote command received:"),console.log(n),!(n.hasOwnProperty("code")&&n.hasOwnProperty("data")&&n.data&&n.data.hasOwnProperty("message")))return void alert(keyy.error_unexpected_response);n&&n.hasOwnProperty("connection_token")&&Keyy.set_connection_token(n.connection_token);var t=(n.code,n.data.message);e("#keyy-admin-body").after('<div id="keyy_connected_message">'+t+"</div>"),o("get_dashboard_page",null,function(n){n&&n.hasOwnProperty("html")?(e("#keyy-admin-body").fadeOut("slow",function(){e(this).replaceWith(n.html),e("#keyy_connect_qrcode").length>0&&Keyy.show_qr_code("#keyy_connect_qrcode","connect")}),setTimeout(function(){e("#keyy_connected_message").slideUp("slow",function(){e(this).remove()})},5e3)):(console.log("Keyy: get_dashboard_page failed"),console.log(n))})})}var o=keyy_send_command_admin_ajax;e("#keyy-admin-body-container").on("change","input",function(){Keyy.save_settings("#keyy-admin-body","#keyy_save_spinner","#keyy_save_done")}),n(),e("#keyy-admin-body-container").on("click","#keyy_disconnect",function(){e("#keyy_disconnect").prop("disabled",!0),o("disconnect",null,function(n){e("#keyy_disconnect").prop("disabled",!1),n&&n.hasOwnProperty("connection_token")&&Keyy.set_connection_token(n.connection_token),n&&n.hasOwnProperty("dashboard_html")?(e("#keyy-admin-body").replaceWith(n.dashboard_html),Keyy.set_connection_status(!1),Keyy.show_qr_code("#keyy_connect_qrcode","connect")):(console.log("Keyy: disconnect: unexpected response:"),console.log(n))})})});